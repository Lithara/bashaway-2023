var P=Object.defineProperty;var ie=Object.getOwnPropertyDescriptor;var re=Object.getOwnPropertyNames;var ne=Object.prototype.hasOwnProperty;var E=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),se=(t,e)=>{for(var i in e)P(t,i,{get:e[i],enumerable:!0})},oe=(t,e,i,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of re(e))!ne.call(t,n)&&n!==i&&P(t,n,{get:()=>e[n],enumerable:!(r=ie(e,n))||r.enumerable});return t};var ce=t=>oe(P({},"__esModule",{value:!0}),t);var $=E(c=>{"use strict";var ue=c&&c.__createBinding||(Object.create?function(t,e,i,r){r===void 0&&(r=i),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,r){r===void 0&&(r=i),t[r]=e[i]}),le=c&&c.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),W=c&&c.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var i in t)i!=="default"&&Object.hasOwnProperty.call(t,i)&&ue(e,t,i);return le(e,t),e},D=c&&c.__awaiter||function(t,e,i,r){function n(s){return s instanceof i?s:new i(function(o){o(s)})}return new(i||(i=Promise))(function(s,o){function d(u){try{l(r.next(u))}catch(m){o(m)}}function h(u){try{l(r.throw(u))}catch(m){o(m)}}function l(u){u.done?s(u.value):n(u.value).then(d,h)}l((r=r.apply(t,e||[])).next())})},_;Object.defineProperty(c,"__esModule",{value:!0});c.getCmdPath=c.tryGetExecutablePath=c.isRooted=c.isDirectory=c.exists=c.IS_WINDOWS=c.unlink=c.symlink=c.stat=c.rmdir=c.rename=c.readlink=c.readdir=c.mkdir=c.lstat=c.copyFile=c.chmod=void 0;var de=W(require("fs")),O=W(require("path"));_=de.promises,c.chmod=_.chmod,c.copyFile=_.copyFile,c.lstat=_.lstat,c.mkdir=_.mkdir,c.readdir=_.readdir,c.readlink=_.readlink,c.rename=_.rename,c.rmdir=_.rmdir,c.stat=_.stat,c.symlink=_.symlink,c.unlink=_.unlink;c.IS_WINDOWS=process.platform==="win32";function ae(t){return D(this,void 0,void 0,function*(){try{yield c.stat(t)}catch(e){if(e.code==="ENOENT")return!1;throw e}return!0})}c.exists=ae;function fe(t,e=!1){return D(this,void 0,void 0,function*(){return(e?yield c.stat(t):yield c.lstat(t)).isDirectory()})}c.isDirectory=fe;function he(t){if(t=ye(t),!t)throw new Error('isRooted() parameter "p" cannot be empty');return c.IS_WINDOWS?t.startsWith("\\")||/^[A-Z]:/i.test(t):t.startsWith("/")}c.isRooted=he;function me(t,e){return D(this,void 0,void 0,function*(){let i;try{i=yield c.stat(t)}catch(n){n.code!=="ENOENT"&&console.log(`Unexpected error attempting to determine if executable file exists '${t}': ${n}`)}if(i&&i.isFile()){if(c.IS_WINDOWS){let n=O.extname(t).toUpperCase();if(e.some(s=>s.toUpperCase()===n))return t}else if(N(i))return t}let r=t;for(let n of e){t=r+n,i=void 0;try{i=yield c.stat(t)}catch(s){s.code!=="ENOENT"&&console.log(`Unexpected error attempting to determine if executable file exists '${t}': ${s}`)}if(i&&i.isFile()){if(c.IS_WINDOWS){try{let s=O.dirname(t),o=O.basename(t).toUpperCase();for(let d of yield c.readdir(s))if(o===d.toUpperCase()){t=O.join(s,d);break}}catch(s){console.log(`Unexpected error attempting to determine the actual case of the file '${t}': ${s}`)}return t}else if(N(i))return t}}return""})}c.tryGetExecutablePath=me;function ye(t){return t=t||"",c.IS_WINDOWS?(t=t.replace(/\//g,"\\"),t.replace(/\\\\+/g,"\\")):t.replace(/\/\/+/g,"/")}function N(t){return(t.mode&1)>0||(t.mode&8)>0&&t.gid===process.getgid()||(t.mode&64)>0&&t.uid===process.getuid()}function pe(){var t;return(t=process.env.COMSPEC)!==null&&t!==void 0?t:"cmd.exe"}c.getCmdPath=pe});var H=E(f=>{"use strict";var _e=f&&f.__createBinding||(Object.create?function(t,e,i,r){r===void 0&&(r=i),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,r){r===void 0&&(r=i),t[r]=e[i]}),we=f&&f.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),T=f&&f.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var i in t)i!=="default"&&Object.hasOwnProperty.call(t,i)&&_e(e,t,i);return we(e,t),e},v=f&&f.__awaiter||function(t,e,i,r){function n(s){return s instanceof i?s:new i(function(o){o(s)})}return new(i||(i=Promise))(function(s,o){function d(u){try{l(r.next(u))}catch(m){o(m)}}function h(u){try{l(r.throw(u))}catch(m){o(m)}}function l(u){u.done?s(u.value):n(u.value).then(d,h)}l((r=r.apply(t,e||[])).next())})};Object.defineProperty(f,"__esModule",{value:!0});f.findInPath=f.which=f.mkdirP=f.rmRF=f.mv=f.cp=void 0;var ve=require("assert"),F=T(require("child_process")),w=T(require("path")),q=require("util"),a=T($()),I=q.promisify(F.exec),be=q.promisify(F.execFile);function ge(t,e,i={}){return v(this,void 0,void 0,function*(){let{force:r,recursive:n,copySourceDirectory:s}=Ee(i),o=(yield a.exists(e))?yield a.stat(e):null;if(o&&o.isFile()&&!r)return;let d=o&&o.isDirectory()&&s?w.join(e,w.basename(t)):e;if(!(yield a.exists(t)))throw new Error(`no such file or directory: ${t}`);if((yield a.stat(t)).isDirectory())if(n)yield L(t,d,0,r);else throw new Error(`Failed to copy. ${t} is a directory, but tried to copy without recursive flag.`);else{if(w.relative(t,d)==="")throw new Error(`'${d}' and '${t}' are the same file`);yield U(t,d,r)}})}f.cp=ge;function Se(t,e,i={}){return v(this,void 0,void 0,function*(){if(yield a.exists(e)){let r=!0;if((yield a.isDirectory(e))&&(e=w.join(e,w.basename(t)),r=yield a.exists(e)),r)if(i.force==null||i.force)yield R(e);else throw new Error("Destination already exists")}yield j(w.dirname(e)),yield a.rename(t,e)})}f.mv=Se;function R(t){return v(this,void 0,void 0,function*(){if(a.IS_WINDOWS){if(/[*"<>|]/.test(t))throw new Error('File path must not contain `*`, `"`, `<`, `>` or `|` on Windows');try{let e=a.getCmdPath();(yield a.isDirectory(t,!0))?yield I(`${e} /s /c "rd /s /q "%inputPath%""`,{env:{inputPath:t}}):yield I(`${e} /s /c "del /f /a "%inputPath%""`,{env:{inputPath:t}})}catch(e){if(e.code!=="ENOENT")throw e}try{yield a.unlink(t)}catch(e){if(e.code!=="ENOENT")throw e}}else{let e=!1;try{e=yield a.isDirectory(t)}catch(i){if(i.code!=="ENOENT")throw i;return}e?yield be("rm",["-rf",`${t}`]):yield a.unlink(t)}})}f.rmRF=R;function j(t){return v(this,void 0,void 0,function*(){ve.ok(t,"a path argument must be provided"),yield a.mkdir(t,{recursive:!0})})}f.mkdirP=j;function M(t,e){return v(this,void 0,void 0,function*(){if(!t)throw new Error("parameter 'tool' is required");if(e){let r=yield M(t,!1);if(!r)throw a.IS_WINDOWS?new Error(`Unable to locate executable file: ${t}. Please verify either the file path exists or the file can be found within a directory specified by the PATH environment variable. Also verify the file has a valid extension for an executable file.`):new Error(`Unable to locate executable file: ${t}. Please verify either the file path exists or the file can be found within a directory specified by the PATH environment variable. Also check the file mode to verify the file is executable.`);return r}let i=yield B(t);return i&&i.length>0?i[0]:""})}f.which=M;function B(t){return v(this,void 0,void 0,function*(){if(!t)throw new Error("parameter 'tool' is required");let e=[];if(a.IS_WINDOWS&&process.env.PATHEXT)for(let n of process.env.PATHEXT.split(w.delimiter))n&&e.push(n);if(a.isRooted(t)){let n=yield a.tryGetExecutablePath(t,e);return n?[n]:[]}if(t.includes(w.sep))return[];let i=[];if(process.env.PATH)for(let n of process.env.PATH.split(w.delimiter))n&&i.push(n);let r=[];for(let n of i){let s=yield a.tryGetExecutablePath(w.join(n,t),e);s&&r.push(s)}return r})}f.findInPath=B;function Ee(t){let e=t.force==null?!0:t.force,i=Boolean(t.recursive),r=t.copySourceDirectory==null?!0:Boolean(t.copySourceDirectory);return{force:e,recursive:i,copySourceDirectory:r}}function L(t,e,i,r){return v(this,void 0,void 0,function*(){if(i>=255)return;i++,yield j(e);let n=yield a.readdir(t);for(let s of n){let o=`${t}/${s}`,d=`${e}/${s}`;(yield a.lstat(o)).isDirectory()?yield L(o,d,i,r):yield U(o,d,r)}yield a.chmod(e,(yield a.stat(t)).mode)})}function U(t,e,i){return v(this,void 0,void 0,function*(){if((yield a.lstat(t)).isSymbolicLink()){try{yield a.lstat(e),yield a.unlink(e)}catch(n){n.code==="EPERM"&&(yield a.chmod(e,"0666"),yield a.unlink(e))}let r=yield a.readlink(t);yield a.symlink(r,e,a.IS_WINDOWS?"junction":null)}else(!(yield a.exists(e))||i)&&(yield a.copyFile(t,e))})}});var X=E(y=>{"use strict";var Oe=y&&y.__createBinding||(Object.create?function(t,e,i,r){r===void 0&&(r=i),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,r){r===void 0&&(r=i),t[r]=e[i]}),xe=y&&y.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),b=y&&y.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var i in t)i!=="default"&&Object.hasOwnProperty.call(t,i)&&Oe(e,t,i);return xe(e,t),e},Q=y&&y.__awaiter||function(t,e,i,r){function n(s){return s instanceof i?s:new i(function(o){o(s)})}return new(i||(i=Promise))(function(s,o){function d(u){try{l(r.next(u))}catch(m){o(m)}}function h(u){try{l(r.throw(u))}catch(m){o(m)}}function l(u){u.done?s(u.value):n(u.value).then(d,h)}l((r=r.apply(t,e||[])).next())})};Object.defineProperty(y,"__esModule",{value:!0});y.argStringToArray=y.ToolRunner=void 0;var x=b(require("os")),G=b(require("events")),Ce=b(require("child_process")),Pe=b(require("path")),De=b(H()),V=b($()),$e=require("timers"),C=process.platform==="win32",A=class extends G.EventEmitter{constructor(e,i,r){if(super(),!e)throw new Error("Parameter 'toolPath' cannot be null or empty.");this.toolPath=e,this.args=i||[],this.options=r||{}}_debug(e){this.options.listeners&&this.options.listeners.debug&&this.options.listeners.debug(e)}_getCommandString(e,i){let r=this._getSpawnFileName(),n=this._getSpawnArgs(e),s=i?"":"[command]";if(C)if(this._isCmdFile()){s+=r;for(let o of n)s+=` ${o}`}else if(e.windowsVerbatimArguments){s+=`"${r}"`;for(let o of n)s+=` ${o}`}else{s+=this._windowsQuoteCmdArg(r);for(let o of n)s+=` ${this._windowsQuoteCmdArg(o)}`}else{s+=r;for(let o of n)s+=` ${o}`}return s}_processLineBuffer(e,i,r){try{let n=i+e.toString(),s=n.indexOf(x.EOL);for(;s>-1;){let o=n.substring(0,s);r(o),n=n.substring(s+x.EOL.length),s=n.indexOf(x.EOL)}return n}catch(n){return this._debug(`error processing line. Failed with error ${n}`),""}}_getSpawnFileName(){return C&&this._isCmdFile()?process.env.COMSPEC||"cmd.exe":this.toolPath}_getSpawnArgs(e){if(C&&this._isCmdFile()){let i=`/D /S /C "${this._windowsQuoteCmdArg(this.toolPath)}`;for(let r of this.args)i+=" ",i+=e.windowsVerbatimArguments?r:this._windowsQuoteCmdArg(r);return i+='"',[i]}return this.args}_endsWith(e,i){return e.endsWith(i)}_isCmdFile(){let e=this.toolPath.toUpperCase();return this._endsWith(e,".CMD")||this._endsWith(e,".BAT")}_windowsQuoteCmdArg(e){if(!this._isCmdFile())return this._uvQuoteCmdArg(e);if(!e)return'""';let i=[" ","	","&","(",")","[","]","{","}","^","=",";","!","'","+",",","`","~","|","<",">",'"'],r=!1;for(let o of e)if(i.some(d=>d===o)){r=!0;break}if(!r)return e;let n='"',s=!0;for(let o=e.length;o>0;o--)n+=e[o-1],s&&e[o-1]==="\\"?n+="\\":e[o-1]==='"'?(s=!0,n+='"'):s=!1;return n+='"',n.split("").reverse().join("")}_uvQuoteCmdArg(e){if(!e)return'""';if(!e.includes(" ")&&!e.includes("	")&&!e.includes('"'))return e;if(!e.includes('"')&&!e.includes("\\"))return`"${e}"`;let i='"',r=!0;for(let n=e.length;n>0;n--)i+=e[n-1],r&&e[n-1]==="\\"?i+="\\":e[n-1]==='"'?(r=!0,i+="\\"):r=!1;return i+='"',i.split("").reverse().join("")}_cloneExecOptions(e){e=e||{};let i={cwd:e.cwd||process.cwd(),env:e.env||process.env,silent:e.silent||!1,windowsVerbatimArguments:e.windowsVerbatimArguments||!1,failOnStdErr:e.failOnStdErr||!1,ignoreReturnCode:e.ignoreReturnCode||!1,delay:e.delay||1e4};return i.outStream=e.outStream||process.stdout,i.errStream=e.errStream||process.stderr,i}_getSpawnOptions(e,i){e=e||{};let r={};return r.cwd=e.cwd,r.env=e.env,r.windowsVerbatimArguments=e.windowsVerbatimArguments||this._isCmdFile(),e.windowsVerbatimArguments&&(r.argv0=`"${i}"`),r}exec(){return Q(this,void 0,void 0,function*(){return!V.isRooted(this.toolPath)&&(this.toolPath.includes("/")||C&&this.toolPath.includes("\\"))&&(this.toolPath=Pe.resolve(process.cwd(),this.options.cwd||process.cwd(),this.toolPath)),this.toolPath=yield De.which(this.toolPath,!0),new Promise((e,i)=>Q(this,void 0,void 0,function*(){this._debug(`exec tool: ${this.toolPath}`),this._debug("arguments:");for(let l of this.args)this._debug(`   ${l}`);let r=this._cloneExecOptions(this.options);!r.silent&&r.outStream&&r.outStream.write(this._getCommandString(r)+x.EOL);let n=new S(r,this.toolPath);if(n.on("debug",l=>{this._debug(l)}),this.options.cwd&&!(yield V.exists(this.options.cwd)))return i(new Error(`The cwd: ${this.options.cwd} does not exist!`));let s=this._getSpawnFileName(),o=Ce.spawn(s,this._getSpawnArgs(r),this._getSpawnOptions(this.options,s)),d="";o.stdout&&o.stdout.on("data",l=>{this.options.listeners&&this.options.listeners.stdout&&this.options.listeners.stdout(l),!r.silent&&r.outStream&&r.outStream.write(l),d=this._processLineBuffer(l,d,u=>{this.options.listeners&&this.options.listeners.stdline&&this.options.listeners.stdline(u)})});let h="";if(o.stderr&&o.stderr.on("data",l=>{n.processStderr=!0,this.options.listeners&&this.options.listeners.stderr&&this.options.listeners.stderr(l),!r.silent&&r.errStream&&r.outStream&&(r.failOnStdErr?r.errStream:r.outStream).write(l),h=this._processLineBuffer(l,h,u=>{this.options.listeners&&this.options.listeners.errline&&this.options.listeners.errline(u)})}),o.on("error",l=>{n.processError=l.message,n.processExited=!0,n.processClosed=!0,n.CheckComplete()}),o.on("exit",l=>{n.processExitCode=l,n.processExited=!0,this._debug(`Exit code ${l} received from tool '${this.toolPath}'`),n.CheckComplete()}),o.on("close",l=>{n.processExitCode=l,n.processExited=!0,n.processClosed=!0,this._debug(`STDIO streams have closed for tool '${this.toolPath}'`),n.CheckComplete()}),n.on("done",(l,u)=>{d.length>0&&this.emit("stdline",d),h.length>0&&this.emit("errline",h),o.removeAllListeners(),l?i(l):e(u)}),this.options.input){if(!o.stdin)throw new Error("child process missing stdin");o.stdin.end(this.options.input)}}))})}};y.ToolRunner=A;function Te(t){let e=[],i=!1,r=!1,n="";function s(o){r&&o!=='"'&&(n+="\\"),n+=o,r=!1}for(let o=0;o<t.length;o++){let d=t.charAt(o);if(d==='"'){r?s(d):i=!i;continue}if(d==="\\"&&r){s(d);continue}if(d==="\\"&&i){r=!0;continue}if(d===" "&&!i){n.length>0&&(e.push(n),n="");continue}s(d)}return n.length>0&&e.push(n.trim()),e}y.argStringToArray=Te;var S=class extends G.EventEmitter{constructor(e,i){if(super(),this.processClosed=!1,this.processError="",this.processExitCode=0,this.processExited=!1,this.processStderr=!1,this.delay=1e4,this.done=!1,this.timeout=null,!i)throw new Error("toolPath must not be empty");this.options=e,this.toolPath=i,e.delay&&(this.delay=e.delay)}CheckComplete(){this.done||(this.processClosed?this._setResult():this.processExited&&(this.timeout=$e.setTimeout(S.HandleTimeout,this.delay,this)))}_debug(e){this.emit("debug",e)}_setResult(){let e;this.processExited&&(this.processError?e=new Error(`There was an error when attempting to execute the process '${this.toolPath}'. This may indicate the process failed to start. Error: ${this.processError}`):this.processExitCode!==0&&!this.options.ignoreReturnCode?e=new Error(`The process '${this.toolPath}' failed with exit code ${this.processExitCode}`):this.processStderr&&this.options.failOnStdErr&&(e=new Error(`The process '${this.toolPath}' failed because one or more lines were written to the STDERR stream`))),this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.done=!0,this.emit("done",e,this.processExitCode)}static HandleTimeout(e){if(!e.done){if(!e.processClosed&&e.processExited){let i=`The STDIO streams did not close within ${e.delay/1e3} seconds of the exit event from process '${e.toolPath}'. This may indicate a child process inherited the STDIO streams and has not yet exited.`;e._debug(i)}e._setResult()}}}});var K=E(p=>{"use strict";var je=p&&p.__createBinding||(Object.create?function(t,e,i,r){r===void 0&&(r=i),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,r){r===void 0&&(r=i),t[r]=e[i]}),Ae=p&&p.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Ne=p&&p.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var i in t)i!=="default"&&Object.hasOwnProperty.call(t,i)&&je(e,t,i);return Ae(e,t),e},k=p&&p.__awaiter||function(t,e,i,r){function n(s){return s instanceof i?s:new i(function(o){o(s)})}return new(i||(i=Promise))(function(s,o){function d(u){try{l(r.next(u))}catch(m){o(m)}}function h(u){try{l(r.throw(u))}catch(m){o(m)}}function l(u){u.done?s(u.value):n(u.value).then(d,h)}l((r=r.apply(t,e||[])).next())})};Object.defineProperty(p,"__esModule",{value:!0});p.getExecOutput=p.exec=void 0;var z=require("string_decoder"),Z=Ne(X());function J(t,e,i){return k(this,void 0,void 0,function*(){let r=Z.argStringToArray(t);if(r.length===0)throw new Error("Parameter 'commandLine' cannot be null or empty.");let n=r[0];return e=r.slice(1).concat(e||[]),new Z.ToolRunner(n,e,i).exec()})}p.exec=J;function We(t,e,i){var r,n;return k(this,void 0,void 0,function*(){let s="",o="",d=new z.StringDecoder("utf8"),h=new z.StringDecoder("utf8"),l=(r=i==null?void 0:i.listeners)===null||r===void 0?void 0:r.stdout,u=(n=i==null?void 0:i.listeners)===null||n===void 0?void 0:n.stderr,m=g=>{o+=h.write(g),u&&u(g)},Y=g=>{s+=d.write(g),l&&l(g)},ee=Object.assign(Object.assign({},i==null?void 0:i.listeners),{stdout:Y,stderr:m}),te=yield J(t,e,Object.assign(Object.assign({},i),{listeners:ee}));return s+=d.end(),o+=h.end(),{exitCode:te,stdout:s,stderr:o}})}p.getExecOutput=We});var Re={};se(Re,{default:()=>qe});module.exports=ce(Re);var Ie=K(),Fe=t=>new Promise((e,i)=>{let r="";Ie.exec(t,[],{listeners:{stdout:n=>{r+=n.toString()}}}).then(()=>e(r)).catch(n=>i(n))}),qe=Fe;0&&(module.exports={});
//# sourceMappingURL=index.js.map
